"""Configuration for source and destination credentials and settings."""

from typing import Dict, List, Any

# Define what credentials each source needs
SOURCE_CREDENTIALS = {
    "rest_api": [
        {
            "key": "REST_API_AUTH_TYPE",
            "label": "Authentication Type",
            "type": "select",
            "required": True,
            "options": [
                {"value": "none", "label": "No Authentication"},
                {"value": "bearer", "label": "Bearer Token"},
                {"value": "api_key", "label": "API Key (Header)"},
                {"value": "basic", "label": "Basic Authentication"},
            ],
            "default": "none",
            "help": "Select how to authenticate with the API"
        },
        {
            "key": "REST_API_BEARER_TOKEN",
            "label": "Bearer Token",
            "type": "password",
            "required": True,
            "show_if": {"REST_API_AUTH_TYPE": "bearer"},
            "placeholder": "your-bearer-token",
            "help": "Token will be sent as: Authorization: Bearer <token>"
        },
        {
            "key": "REST_API_KEY_NAME",
            "label": "API Key Header Name",
            "type": "text",
            "required": True,
            "show_if": {"REST_API_AUTH_TYPE": "api_key"},
            "placeholder": "X-API-Key",
            "help": "Header name for the API key (e.g., X-API-Key, ApiKey)"
        },
        {
            "key": "REST_API_KEY_VALUE",
            "label": "API Key Value",
            "type": "password",
            "required": True,
            "show_if": {"REST_API_AUTH_TYPE": "api_key"},
            "placeholder": "your-api-key"
        },
        {
            "key": "REST_API_BASIC_USERNAME",
            "label": "Username",
            "type": "text",
            "required": True,
            "show_if": {"REST_API_AUTH_TYPE": "basic"},
            "placeholder": "username"
        },
        {
            "key": "REST_API_BASIC_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": True,
            "show_if": {"REST_API_AUTH_TYPE": "basic"},
            "placeholder": "password"
        }
    ],
    "github": [
        {
            "key": "GITHUB_TOKEN",
            "label": "GitHub Personal Access Token",
            "type": "password",
            "required": True,
            "help": "Create at: https://github.com/settings/tokens",
            "placeholder": "ghp_xxxxxxxxxxxx"
        }
    ],
    "stripe": [
        {
            "key": "STRIPE_SECRET_KEY",
            "label": "Stripe Secret Key",
            "type": "password",
            "required": True,
            "help": "Find in Stripe Dashboard → Developers → API Keys",
            "placeholder": "sk_live_xxxxxxxxxxxx"
        }
    ],
    "shopify": [
        {
            "key": "SHOPIFY_ACCESS_TOKEN",
            "label": "Shopify Access Token",
            "type": "password",
            "required": True,
            "help": "Create a private app in Shopify admin",
            "placeholder": "shpat_xxxxxxxxxxxx"
        },
        {
            "key": "SHOPIFY_SHOP_NAME",
            "label": "Shop Name",
            "type": "text",
            "required": True,
            "help": "Your store name (from mystore.myshopify.com)",
            "placeholder": "mystore"
        }
    ],
    "salesforce": [
        {
            "key": "SALESFORCE_USERNAME",
            "label": "Salesforce Username",
            "type": "text",
            "required": True,
            "placeholder": "user@company.com"
        },
        {
            "key": "SALESFORCE_PASSWORD",
            "label": "Salesforce Password",
            "type": "password",
            "required": True
        },
        {
            "key": "SALESFORCE_SECURITY_TOKEN",
            "label": "Security Token",
            "type": "password",
            "required": True,
            "help": "Reset at: Setup → My Personal Information → Reset Security Token"
        }
    ],
    "postgres": [
        {
            "key": "POSTGRES_AUTH_METHOD",
            "label": "Authentication Method",
            "type": "select",
            "required": True,
            "options": [
                {"value": "password", "label": "Password"},
                {"value": "certificate", "label": "SSL Certificate (more secure)"},
            ],
            "default": "password"
        },
        {
            "key": "POSTGRES_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "POSTGRES_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "5432"
        },
        {
            "key": "POSTGRES_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "mydb"
        },
        {
            "key": "POSTGRES_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "postgres"
        },
        {
            "key": "POSTGRES_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": False,
            "show_if": {"POSTGRES_AUTH_METHOD": "password"},
            "help": "Only required for password authentication"
        },
        {
            "key": "POSTGRES_SSL_CERT",
            "label": "SSL Client Certificate Path",
            "type": "text",
            "required": False,
            "show_if": {"POSTGRES_AUTH_METHOD": "certificate"},
            "placeholder": "/path/to/client-cert.pem",
            "help": "Path to client certificate file"
        },
        {
            "key": "POSTGRES_SSL_KEY",
            "label": "SSL Client Key Path",
            "type": "text",
            "required": False,
            "show_if": {"POSTGRES_AUTH_METHOD": "certificate"},
            "placeholder": "/path/to/client-key.pem",
            "help": "Path to client private key file"
        },
        {
            "key": "POSTGRES_SSL_ROOT_CERT",
            "label": "SSL Root Certificate Path",
            "type": "text",
            "required": False,
            "show_if": {"POSTGRES_AUTH_METHOD": "certificate"},
            "placeholder": "/path/to/root-cert.pem",
            "help": "Path to root CA certificate"
        }
    ],
    "mysql": [
        {
            "key": "MYSQL_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "MYSQL_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "3306"
        },
        {
            "key": "MYSQL_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "mydb"
        },
        {
            "key": "MYSQL_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "root"
        },
        {
            "key": "MYSQL_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": True
        }
    ],
    "mongodb": [
        {
            "key": "MONGODB_CONNECTION_STRING",
            "label": "Connection String",
            "type": "password",
            "required": True,
            "help": "Format: mongodb://user:password@host:port/database",
            "placeholder": "mongodb://localhost:27017/mydb"
        }
    ],
    "trino": [
        {
            "key": "TRINO_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "TRINO_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "8080"
        },
        {
            "key": "TRINO_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "trino"
        },
        {
            "key": "TRINO_CATALOG",
            "label": "Catalog",
            "type": "text",
            "required": True,
            "placeholder": "hive"
        },
        {
            "key": "TRINO_SCHEMA",
            "label": "Schema",
            "type": "text",
            "required": True,
            "placeholder": "default"
        }
    ],
    "clickhouse": [
        {
            "key": "CLICKHOUSE_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "CLICKHOUSE_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "9000"
        },
        {
            "key": "CLICKHOUSE_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "default"
        },
        {
            "key": "CLICKHOUSE_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "default"
        },
        {
            "key": "CLICKHOUSE_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": False
        }
    ],
    "mssql": [
        {
            "key": "MSSQL_HOST",
            "label": "Server",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "MSSQL_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "1433"
        },
        {
            "key": "MSSQL_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "master"
        },
        {
            "key": "MSSQL_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "sa"
        },
        {
            "key": "MSSQL_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": True
        }
    ]
}

# Define what credentials each destination needs
DESTINATION_CREDENTIALS = {
    "snowflake": [
        {
            "key": "SNOWFLAKE_AUTH_METHOD",
            "label": "Authentication Method",
            "type": "select",
            "required": True,
            "options": [
                {"value": "password", "label": "Username & Password (least secure)"},
                {"value": "keypair", "label": "Key Pair Authentication (recommended)"},
            ],
            "default": "password",
            "help": "Key pair is more secure and recommended for production"
        },
        {
            "key": "SNOWFLAKE_ACCOUNT",
            "label": "Account",
            "type": "text",
            "required": True,
            "help": "Format: xy12345.us-east-1 (from Snowflake URL)",
            "placeholder": "xy12345.us-east-1"
        },
        {
            "key": "SNOWFLAKE_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "myuser"
        },
        {
            "key": "SNOWFLAKE_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": False,
            "show_if": {"SNOWFLAKE_AUTH_METHOD": "password"},
            "help": "Only required for password authentication"
        },
        {
            "key": "SNOWFLAKE_PRIVATE_KEY",
            "label": "Private Key (PEM format)",
            "type": "textarea",
            "required": False,
            "show_if": {"SNOWFLAKE_AUTH_METHOD": "keypair"},
            "help": "RSA private key in PEM format. Generate with: openssl genrsa -out rsa_key.pem 2048",
            "placeholder": "-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"
        },
        {
            "key": "SNOWFLAKE_PRIVATE_KEY_PASSPHRASE",
            "label": "Private Key Passphrase (optional)",
            "type": "password",
            "required": False,
            "show_if": {"SNOWFLAKE_AUTH_METHOD": "keypair"},
            "help": "Only if your private key is encrypted"
        },
        {
            "key": "SNOWFLAKE_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "analytics"
        },
        {
            "key": "SNOWFLAKE_WAREHOUSE",
            "label": "Warehouse",
            "type": "text",
            "required": True,
            "placeholder": "compute_wh"
        },
        {
            "key": "SNOWFLAKE_ROLE",
            "label": "Role",
            "type": "text",
            "required": False,
            "placeholder": "analyst"
        }
    ],
    "bigquery": [
        {
            "key": "GCP_PROJECT_ID",
            "label": "GCP Project ID",
            "type": "text",
            "required": True,
            "placeholder": "my-project-123"
        },
        {
            "key": "GCP_CREDENTIALS",
            "label": "Service Account JSON",
            "type": "textarea",
            "required": True,
            "help": "Paste the entire JSON content from your service account key file",
            "placeholder": '{"type": "service_account", "project_id": "..."}'
        }
    ],
    "redshift": [
        {
            "key": "REDSHIFT_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "cluster.xyz.region.redshift.amazonaws.com"
        },
        {
            "key": "REDSHIFT_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "5439"
        },
        {
            "key": "REDSHIFT_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "analytics"
        },
        {
            "key": "REDSHIFT_USER",
            "label": "Username",
            "type": "text",
            "required": True
        },
        {
            "key": "REDSHIFT_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": True
        }
    ],
    "postgres": [
        {
            "key": "DEST_POSTGRES_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "DEST_POSTGRES_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "5432"
        },
        {
            "key": "DEST_POSTGRES_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "warehouse"
        },
        {
            "key": "DEST_POSTGRES_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "postgres"
        },
        {
            "key": "DEST_POSTGRES_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": True
        }
    ],
    "duckdb": [
        {
            "key": "DEST_DUCKDB_PATH",
            "label": "Database File Path",
            "type": "text",
            "required": False,
            "placeholder": "/path/to/warehouse.duckdb",
            "help": "Leave empty for in-memory database (data.duckdb will be created by default)"
        }
    ],
    "motherduck": [
        {
            "key": "MOTHERDUCK_TOKEN",
            "label": "MotherDuck Token",
            "type": "password",
            "required": True,
            "help": "Find at: app.motherduck.com → Settings → API Tokens"
        },
        {
            "key": "MOTHERDUCK_DATABASE",
            "label": "Database Name",
            "type": "text",
            "required": False,
            "placeholder": "my_db",
            "help": "Optional - will be created if it doesn't exist"
        }
    ],
    "databricks": [
        {
            "key": "DATABRICKS_HOST",
            "label": "Databricks Host",
            "type": "text",
            "required": True,
            "placeholder": "adb-1234567890123456.7.azuredatabricks.net"
        },
        {
            "key": "DATABRICKS_TOKEN",
            "label": "Access Token",
            "type": "password",
            "required": True,
            "help": "Create at: User Settings → Developer → Access Tokens"
        },
        {
            "key": "DATABRICKS_HTTP_PATH",
            "label": "HTTP Path",
            "type": "text",
            "required": True,
            "placeholder": "/sql/1.0/warehouses/abc123",
            "help": "Find in SQL Warehouse → Connection Details"
        },
        {
            "key": "DATABRICKS_CATALOG",
            "label": "Catalog",
            "type": "text",
            "required": False,
            "placeholder": "main"
        }
    ],
    "clickhouse": [
        {
            "key": "CLICKHOUSE_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "CLICKHOUSE_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "9000"
        },
        {
            "key": "CLICKHOUSE_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "default"
        },
        {
            "key": "CLICKHOUSE_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": True
        },
        {
            "key": "CLICKHOUSE_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "default"
        }
    ],
    "mysql": [
        {
            "key": "DEST_MYSQL_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "DEST_MYSQL_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "3306"
        },
        {
            "key": "DEST_MYSQL_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "warehouse"
        },
        {
            "key": "DEST_MYSQL_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "root"
        },
        {
            "key": "DEST_MYSQL_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": True
        }
    ],
    "sqlite": [
        {
            "key": "DEST_SQLITE_PATH",
            "label": "Database File Path",
            "type": "text",
            "required": True,
            "placeholder": "/path/to/warehouse.db"
        }
    ],
    "filesystem": [
        {
            "key": "DEST_FILESYSTEM_PATH",
            "label": "Output Directory",
            "type": "text",
            "required": True,
            "placeholder": "/path/to/output",
            "help": "Directory where files will be written"
        }
    ],
    "trino": [
        {
            "key": "TRINO_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "TRINO_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "8080"
        },
        {
            "key": "TRINO_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "trino"
        },
        {
            "key": "TRINO_CATALOG",
            "label": "Catalog",
            "type": "text",
            "required": True,
            "placeholder": "hive"
        },
        {
            "key": "TRINO_SCHEMA",
            "label": "Schema",
            "type": "text",
            "required": True,
            "placeholder": "default"
        }
    ],
    "elasticsearch": [
        {
            "key": "ELASTICSEARCH_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost:9200",
            "help": "Elasticsearch host with port"
        },
        {
            "key": "ELASTICSEARCH_USERNAME",
            "label": "Username",
            "type": "text",
            "required": False,
            "placeholder": "elastic"
        },
        {
            "key": "ELASTICSEARCH_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": False
        },
        {
            "key": "ELASTICSEARCH_API_KEY",
            "label": "API Key (alternative to password)",
            "type": "password",
            "required": False,
            "help": "Use either API key or username/password"
        }
    ],
    "clickhouse": [
        {
            "key": "CLICKHOUSE_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "CLICKHOUSE_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "9000"
        },
        {
            "key": "CLICKHOUSE_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "default"
        },
        {
            "key": "CLICKHOUSE_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "default"
        },
        {
            "key": "CLICKHOUSE_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": False
        }
    ],
    "mssql": [
        {
            "key": "MSSQL_HOST",
            "label": "Server",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "MSSQL_PORT",
            "label": "Port",
            "type": "text",
            "required": False,
            "placeholder": "1433"
        },
        {
            "key": "MSSQL_DATABASE",
            "label": "Database",
            "type": "text",
            "required": True,
            "placeholder": "master"
        },
        {
            "key": "MSSQL_USER",
            "label": "Username",
            "type": "text",
            "required": True,
            "placeholder": "sa"
        },
        {
            "key": "MSSQL_PASSWORD",
            "label": "Password",
            "type": "password",
            "required": True
        }
    ],
    "druid": [
        {
            "key": "DRUID_HOST",
            "label": "Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost:8888",
            "help": "Druid router host with port"
        },
        {
            "key": "DRUID_USER",
            "label": "Username (optional)",
            "type": "text",
            "required": False
        },
        {
            "key": "DRUID_PASSWORD",
            "label": "Password (optional)",
            "type": "password",
            "required": False
        }
    ],
    "pinot": [
        {
            "key": "PINOT_BROKER_HOST",
            "label": "Broker Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "PINOT_BROKER_PORT",
            "label": "Broker Port",
            "type": "text",
            "required": False,
            "placeholder": "8099"
        },
        {
            "key": "PINOT_CONTROLLER_HOST",
            "label": "Controller Host",
            "type": "text",
            "required": True,
            "placeholder": "localhost"
        },
        {
            "key": "PINOT_CONTROLLER_PORT",
            "label": "Controller Port",
            "type": "text",
            "required": False,
            "placeholder": "9000"
        }
    ]
}

# Add more common sources
SOURCE_CREDENTIALS.update({
    "hubspot": [
        {"key": "HUBSPOT_API_KEY", "label": "HubSpot API Key", "type": "password", "required": True,
         "help": "Find in Settings → Integrations → API Key"}
    ],
    "google_analytics": [
        {"key": "GOOGLE_ANALYTICS_CREDENTIALS", "label": "Service Account JSON", "type": "textarea",
         "required": True, "help": "Service account with Analytics API access"}
    ],
    "slack": [
        {"key": "SLACK_BOT_TOKEN", "label": "Bot Token", "type": "password", "required": True,
         "help": "Starts with xoxb-", "placeholder": "xoxb-xxxxxxxxxxxx"}
    ],
    "notion": [
        {"key": "NOTION_TOKEN", "label": "Integration Token", "type": "password", "required": True,
         "help": "Create at: https://www.notion.so/my-integrations"}
    ],
    "airtable": [
        {"key": "AIRTABLE_API_KEY", "label": "API Key", "type": "password", "required": True,
         "help": "Find in Account settings"}
    ],
    "zendesk": [
        {"key": "ZENDESK_SUBDOMAIN", "label": "Subdomain", "type": "text", "required": True,
         "placeholder": "mycompany", "help": "From mycompany.zendesk.com"},
        {"key": "ZENDESK_EMAIL", "label": "Email", "type": "text", "required": True},
        {"key": "ZENDESK_API_TOKEN", "label": "API Token", "type": "password", "required": True}
    ],
    "jira": [
        {"key": "JIRA_DOMAIN", "label": "Domain", "type": "text", "required": True,
         "placeholder": "mycompany.atlassian.net"},
        {"key": "JIRA_EMAIL", "label": "Email", "type": "text", "required": True},
        {"key": "JIRA_API_TOKEN", "label": "API Token", "type": "password", "required": True}
    ],
    "facebook_ads": [
        {"key": "FACEBOOK_ACCESS_TOKEN", "label": "Access Token", "type": "password", "required": True,
         "help": "Create at: developers.facebook.com"}
    ],
    "google_ads": [
        {"key": "GOOGLE_ADS_DEVELOPER_TOKEN", "label": "Developer Token", "type": "password", "required": True},
        {"key": "GOOGLE_ADS_CLIENT_ID", "label": "Client ID", "type": "text", "required": True},
        {"key": "GOOGLE_ADS_CLIENT_SECRET", "label": "Client Secret", "type": "password", "required": True},
        {"key": "GOOGLE_ADS_REFRESH_TOKEN", "label": "Refresh Token", "type": "password", "required": True}
    ],
    "intercom": [
        {"key": "INTERCOM_ACCESS_TOKEN", "label": "Access Token", "type": "password", "required": True,
         "help": "Find in Intercom Developer Hub"}
    ],
    "mixpanel": [
        {"key": "MIXPANEL_API_SECRET", "label": "API Secret", "type": "password", "required": True,
         "help": "Find in Project Settings"}
    ],
    "segment": [
        {"key": "SEGMENT_WRITE_KEY", "label": "Write Key", "type": "password", "required": True,
         "help": "Find in Source Settings"}
    ],
    "asana": [
        {"key": "ASANA_ACCESS_TOKEN", "label": "Personal Access Token", "type": "password", "required": True,
         "help": "Create at: app.asana.com/0/my-apps"}
    ],
    "duckdb": [
        {"key": "DUCKDB_PATH", "label": "Database File Path", "type": "text", "required": False,
         "placeholder": "/path/to/database.duckdb",
         "help": "Leave empty for in-memory database"}
    ],
    "sqlite": [
        {"key": "SQLITE_PATH", "label": "Database File Path", "type": "text", "required": True,
         "placeholder": "/path/to/database.db"}
    ],
    "s3": [
        {"key": "AWS_ACCESS_KEY_ID", "label": "AWS Access Key ID", "type": "text", "required": True},
        {"key": "AWS_SECRET_ACCESS_KEY", "label": "AWS Secret Access Key", "type": "password", "required": True},
        {"key": "AWS_REGION", "label": "AWS Region", "type": "text", "required": False,
         "placeholder": "us-east-1"}
    ],
    "gcs": [
        {"key": "GCS_CREDENTIALS", "label": "Service Account JSON", "type": "textarea", "required": True,
         "help": "Service account with Storage Object Viewer permission"}
    ],
    "azure_blob": [
        {"key": "AZURE_STORAGE_ACCOUNT_NAME", "label": "Storage Account Name", "type": "text", "required": True},
        {"key": "AZURE_STORAGE_ACCOUNT_KEY", "label": "Storage Account Key", "type": "password", "required": True}
    ],
    "csv": [],  # No credentials needed for local CSV files
    "json": [],  # No credentials needed for local JSON files
    "parquet": []  # No credentials needed for local Parquet files
})


def get_required_credentials(source_type: str, destination_type: str) -> Dict[str, List[Dict[str, Any]]]:
    """Get required credentials for a source and destination combination."""
    credentials = {}

    # Get source credentials
    source_creds = SOURCE_CREDENTIALS.get(source_type.lower(), [])
    if source_creds:
        credentials["source"] = source_creds

    # Get destination credentials
    dest_creds = DESTINATION_CREDENTIALS.get(destination_type.lower(), [])
    if dest_creds:
        credentials["destination"] = dest_creds

    return credentials


# Source configuration fields (what data to load, not credentials)
SOURCE_CONFIGURATIONS = {
    "rest_api": [
        {
            "key": "base_url",
            "label": "Base URL",
            "type": "text",
            "required": True,
            "help": "The base URL for your API (e.g., https://api.example.com)",
            "placeholder": "https://api.example.com"
        },
        {
            "key": "resource_name",
            "label": "Resource Name",
            "type": "text",
            "required": True,
            "help": "Name for this data resource (will be used as table name)",
            "placeholder": "users"
        },
        {
            "key": "endpoint",
            "label": "Endpoint Path",
            "type": "text",
            "required": True,
            "help": "API endpoint path (e.g., /v1/users)",
            "placeholder": "/v1/users"
        },
        {
            "key": "http_method",
            "label": "HTTP Method",
            "type": "select",
            "required": True,
            "options": [
                {"value": "GET", "label": "GET"},
                {"value": "POST", "label": "POST"}
            ],
            "default": "GET"
        },
        {
            "key": "pagination_type",
            "label": "Pagination Strategy",
            "type": "select",
            "required": False,
            "options": [
                {"value": "none", "label": "No Pagination"},
                {"value": "auto", "label": "Auto-detect (DLT will try to detect)"},
                {"value": "offset", "label": "Offset-based (page number or offset)"},
                {"value": "cursor", "label": "Cursor-based (next page token)"},
                {"value": "json_link", "label": "JSON Link (next page URL in response)"}
            ],
            "default": "auto",
            "help": "How the API handles pagination"
        },
        {
            "key": "data_selector",
            "label": "Data Selector (JSON Path)",
            "type": "text",
            "required": False,
            "help": "Path to data in response (e.g., 'data.items' or 'results')",
            "placeholder": "data"
        },
        {
            "key": "advanced_mode",
            "label": "Advanced Mode",
            "type": "boolean",
            "default": False,
            "help": "Enable advanced JSON configuration for complex APIs"
        },
        {
            "key": "advanced_config",
            "label": "Advanced Configuration (JSON)",
            "type": "textarea",
            "required": False,
            "show_if": {"advanced_mode": True},
            "help": "Full REST API client configuration in JSON format. See DLT documentation for details.",
            "placeholder": '''{
  "client": {
    "base_url": "https://api.example.com",
    "paginator": {
      "type": "json_link",
      "next_url_path": "paging.next"
    }
  },
  "resources": [
    {
      "name": "users",
      "endpoint": {
        "path": "/users",
        "params": {
          "limit": 100
        }
      }
    }
  ]
}'''
        }
    ],
    "github": [
        {
            "key": "repos",
            "label": "Which repositories do you want to load?",
            "type": "text",
            "required": True,
            "help": "Comma-separated list of repos in format owner/repo",
            "placeholder": "dlt-hub/dlt, dagster-io/dagster"
        },
        {
            "key": "resources",
            "label": "Select resources to load",
            "type": "multiselect",
            "required": False,
            "help": "Select which GitHub resources to sync",
            "options": [
                {"value": "issues", "label": "Issues"},
                {"value": "pull_requests", "label": "Pull Requests"},
                {"value": "commits", "label": "Commits"},
                {"value": "stargazers", "label": "Stargazers"},
                {"value": "workflows", "label": "Workflows"},
                {"value": "releases", "label": "Releases"}
            ],
            "default": ["issues", "pull_requests"]
        }
    ],
    "stripe": [
        {
            "key": "resources",
            "label": "Select resources to load",
            "type": "multiselect",
            "required": False,
            "help": "Select which Stripe resources to sync",
            "options": [
                {"value": "customers", "label": "Customers"},
                {"value": "invoices", "label": "Invoices"},
                {"value": "charges", "label": "Charges"},
                {"value": "subscriptions", "label": "Subscriptions"},
                {"value": "products", "label": "Products"},
                {"value": "payment_intents", "label": "Payment Intents"}
            ],
            "default": ["customers", "invoices", "charges"]
        }
    ],
    "shopify": [
        {
            "key": "resources",
            "label": "Select resources to load",
            "type": "multiselect",
            "required": False,
            "options": [
                {"value": "orders", "label": "Orders"},
                {"value": "customers", "label": "Customers"},
                {"value": "products", "label": "Products"},
                {"value": "inventory", "label": "Inventory"},
                {"value": "fulfillments", "label": "Fulfillments"}
            ],
            "default": ["orders", "customers", "products"]
        }
    ],
    "salesforce": [
        {
            "key": "objects",
            "label": "Which Salesforce objects?",
            "type": "text",
            "required": True,
            "help": "Comma-separated list of Salesforce objects",
            "placeholder": "Account, Contact, Opportunity, Lead"
        },
        {
            "key": "use_bulk_api",
            "label": "Use Bulk API (for large datasets)",
            "type": "boolean",
            "default": True
        }
    ],
    "hubspot": [
        {
            "key": "resources",
            "label": "Select resources to load",
            "type": "multiselect",
            "required": False,
            "options": [
                {"value": "contacts", "label": "Contacts"},
                {"value": "companies", "label": "Companies"},
                {"value": "deals", "label": "Deals"},
                {"value": "tickets", "label": "Tickets"},
                {"value": "products", "label": "Products"}
            ],
            "default": ["contacts", "companies", "deals"]
        }
    ],
    "postgres": [
        {
            "key": "schemas",
            "label": "Schema names (comma-separated)",
            "type": "text",
            "required": False,
            "placeholder": "public, analytics",
            "help": "Leave empty to load all schemas"
        },
        {
            "key": "tables",
            "label": "Table names (comma-separated)",
            "type": "text",
            "required": False,
            "placeholder": "users, orders, products",
            "help": "Leave empty to load all tables"
        },
        {
            "key": "incremental",
            "label": "Use incremental loading",
            "type": "boolean",
            "default": True,
            "help": "Only load new/changed data on subsequent runs"
        }
    ],
    "mysql": [
        {
            "key": "schemas",
            "label": "Database/Schema names (comma-separated)",
            "type": "text",
            "required": False,
            "placeholder": "mydb, analytics",
            "help": "Leave empty to load all databases"
        },
        {
            "key": "tables",
            "label": "Table names (comma-separated)",
            "type": "text",
            "required": False,
            "placeholder": "users, orders, products",
            "help": "Leave empty to load all tables"
        },
        {
            "key": "incremental",
            "label": "Use incremental loading",
            "type": "boolean",
            "default": True
        }
    ],
    "mongodb": [
        {
            "key": "collections",
            "label": "Collection names (comma-separated)",
            "type": "text",
            "required": False,
            "placeholder": "users, orders, products",
            "help": "Leave empty to load all collections"
        }
    ],
    "google_analytics": [
        {
            "key": "property_id",
            "label": "GA4 Property ID",
            "type": "text",
            "required": True,
            "placeholder": "123456789"
        },
        {
            "key": "dimensions",
            "label": "Dimensions (comma-separated)",
            "type": "text",
            "required": False,
            "placeholder": "date, city, deviceCategory",
            "help": "GA4 dimension names"
        },
        {
            "key": "metrics",
            "label": "Metrics (comma-separated)",
            "type": "text",
            "required": False,
            "placeholder": "activeUsers, sessions, pageviews",
            "help": "GA4 metric names"
        }
    ],
    "zendesk": [
        {
            "key": "resources",
            "label": "Select resources to load",
            "type": "multiselect",
            "required": False,
            "options": [
                {"value": "tickets", "label": "Tickets"},
                {"value": "users", "label": "Users"},
                {"value": "organizations", "label": "Organizations"},
                {"value": "groups", "label": "Groups"}
            ],
            "default": ["tickets", "users"]
        }
    ],
    "jira": [
        {
            "key": "projects",
            "label": "Project keys (comma-separated)",
            "type": "text",
            "required": False,
            "placeholder": "PROJ1, PROJ2",
            "help": "Leave empty to load all projects"
        },
        {
            "key": "resources",
            "label": "Select resources to load",
            "type": "multiselect",
            "required": False,
            "options": [
                {"value": "issues", "label": "Issues"},
                {"value": "users", "label": "Users"},
                {"value": "projects", "label": "Projects"},
                {"value": "workflows", "label": "Workflows"}
            ],
            "default": ["issues", "projects"]
        }
    ],
    "slack": [
        {
            "key": "channels",
            "label": "Channel IDs (comma-separated)",
            "type": "text",
            "required": False,
            "placeholder": "C1234567890, C0987654321",
            "help": "Leave empty to load all channels"
        },
        {
            "key": "include_private",
            "label": "Include private channels",
            "type": "boolean",
            "default": False
        }
    ],
    "s3": [
        {
            "key": "bucket",
            "label": "S3 Bucket Name",
            "type": "text",
            "required": True,
            "placeholder": "my-data-bucket"
        },
        {
            "key": "prefix",
            "label": "Prefix/Path",
            "type": "text",
            "required": False,
            "placeholder": "data/exports/",
            "help": "Optional path within the bucket"
        },
        {
            "key": "file_format",
            "label": "File Format",
            "type": "text",
            "required": False,
            "placeholder": "csv, json, parquet",
            "help": "Expected file format in the bucket"
        }
    ],
    "csv": [
        {
            "key": "file_path",
            "label": "CSV File Path",
            "type": "text",
            "required": True,
            "placeholder": "/path/to/data.csv"
        },
        {
            "key": "delimiter",
            "label": "Delimiter",
            "type": "text",
            "required": False,
            "placeholder": ",",
            "default": ","
        }
    ]
}


def get_source_configuration(source_type: str) -> List[Dict[str, Any]]:
    """Get configuration options for a source type (beyond credentials)."""
    return SOURCE_CONFIGURATIONS.get(source_type.lower(), [])


def get_connection_string_template(source_type: str = None, destination_type: str = None) -> str:
    """Get connection string template for Sling connections."""
    if source_type:
        type_lower = source_type.lower()
        if type_lower == "postgres":
            return "postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT:-5432}/${POSTGRES_DATABASE}"
        elif type_lower == "mysql":
            return "mysql://${MYSQL_USER}:${MYSQL_PASSWORD}@${MYSQL_HOST}:${MYSQL_PORT:-3306}/${MYSQL_DATABASE}"
        elif type_lower == "mongodb":
            return "${MONGODB_CONNECTION_STRING}"

    if destination_type:
        type_lower = destination_type.lower()
        if type_lower == "snowflake":
            return "snowflake://${SNOWFLAKE_USER}:${SNOWFLAKE_PASSWORD}@${SNOWFLAKE_ACCOUNT}/${SNOWFLAKE_DATABASE}?warehouse=${SNOWFLAKE_WAREHOUSE}"
        elif type_lower == "bigquery":
            return "bigquery://${GCP_PROJECT_ID}?credentials_path=credentials.json"
        elif type_lower == "postgres":
            return "postgresql://${DEST_POSTGRES_USER}:${DEST_POSTGRES_PASSWORD}@${DEST_POSTGRES_HOST}:${DEST_POSTGRES_PORT:-5432}/${DEST_POSTGRES_DATABASE}"

    return ""
